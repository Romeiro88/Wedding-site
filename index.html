<index html> 
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–°–≤–∞–¥—å–±–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏–∏ –∏ –†–æ–º–∞–Ω–∞ ‚Äî –ë–∞—Ä–æ–∫–∫–æ</title>
<meta name="description" content="–°–≤–∞–¥–µ–±–Ω–∞—è –≥–∞–ª–µ—Ä–µ—è ‚Äî —Ñ–æ—Ç–æ –∏ –≤–∏–¥–µ–æ. –ë–∞—Ä–æ—á–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ, –º—É–∑—ã–∫–∞, –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä." />
<style>
  :root{
    --bg:#fffaf3;
    --muted:#423f3a;
    --gold:#d4af37;
    --glass: rgba(255,255,255,0.76);
    --shadow: 0 18px 60px rgba(20,18,16,0.12);
    --maxw:1100px;
    --trans: .6s cubic-bezier(.2,.9,.24,1);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--bg); color:var(--muted); -webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}

  body::before{
    content:"";
    position:fixed; inset:0; z-index:-2; pointer-events:none;
    background-image: url("https://disk.yandex.ru/i/52X_ClrcdF2h4Q");
    background-repeat: repeat;
    background-size: 400px 400px;
    opacity: 0.15;
  }

  .page{max-width:var(--maxw);margin:30px auto;padding:18px; position:relative; z-index:0}
  header{text-align:center;margin-bottom:8px}
  svg.orn{width:240px;height:72px;display:block;margin:0 auto 8px}
  h1{margin:0;font-size:30px;color:#111;font-weight:700}

  .music-btn{ position:fixed; right:18px; top:18px; width:56px;height:56px;border-radius:50%; background:linear-gradient(180deg,#fff,#fff7e5); border:2px solid rgba(212,175,55,0.16); box-shadow:0 12px 30px rgba(212,175,55,0.08); display:flex;align-items:center;justify-content:center; cursor:pointer; z-index:9999 }
  .music-btn.play{ transform:scale(1.03); box-shadow:0 18px 48px rgba(212,175,55,0.14) }

  .stage-wrap{ display:flex; flex-direction:column; gap:22px; align-items:center; z-index:1 }
  .stage{ width:100%; padding:18px; border-radius:20px; box-shadow:var(--shadow); background: linear-gradient(180deg, rgba(255,255,255,0.94), rgba(255,250,240,0.94)); }
  .content{ width:100%; max-width:980px; margin:0 auto; position:relative; }

  .slider{ height:calc(85vh); border-radius:14px; overflow:hidden; display:flex; align-items:center; justify-content:center; position:relative; background:linear-gradient(180deg,#fffdf8,#fff); }
  .slides{ display:flex; height:100%; transition:transform var(--trans); will-change:transform; }
  .slide{ min-width:100%; height:100%; display:flex; align-items:center; justify-content:center; padding:28px; box-sizing:border-box; position:relative; opacity:0; transition:opacity .45s ease; }
  .slide.active{ opacity:1; }
  .photo-frame{ width:calc(100% - 120px); max-width:1100px; height:calc(100% - 140px); border-radius:14px; overflow:hidden; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg,#fff,#fffaf0); border:1px solid rgba(212,175,55,0.08); box-shadow:0 40px 120px rgba(20,18,16,0.14); position:relative; }
  .photo-frame img{ width:100%; height:100%; object-fit:contain; object-position:center center; display:block; transition:transform .9s ease, filter .6s ease; background:#fbf9f5; }

  .arrow{ position:absolute; top:50%; transform:translateY(-50%); width:72px;height:72px;border-radius:50%; display:flex;align-items:center;justify-content:center; font-size:34px; cursor:pointer; background:linear-gradient(180deg,#fff,#fff7e5); border:2px solid rgba(212,175,55,0.12); box-shadow:0 16px 40px rgba(20,18,16,0.12); z-index:60; }
  .arrow.left{ left:36px } .arrow.right{ right:36px }

  .stage:fullscreen, .stage:-webkit-full-screen{ background:#000; padding:0; border-radius:0; height:100vh; }
  .stage:fullscreen .content, .stage:-webkit-full-screen .content{ width:100vw; height:100vh; max-width:100vw; display:flex; align-items:center; justify-content:center; }
  .stage:fullscreen .photo-frame, .stage:-webkit-full-screen .photo-frame{ width:100vw; height:100vh; max-width:none; border-radius:0; border:none; box-shadow:none; }
  .stage:fullscreen .arrow, .stage:-webkit-full-screen .arrow{ background:rgba(255,255,255,0.06); color:#fff; border-color:rgba(255,255,255,0.06); }

  .top-controls{ position:absolute; right:26px; top:22px; z-index:75; display:flex; gap:10px }
  .control-sm{ padding:8px 12px; border-radius:10px; background:linear-gradient(180deg,#fff,#fff7e6); border:1px solid rgba(212,175,55,0.1); font-weight:700; cursor:pointer }

  .dots{ position:absolute; bottom:18px; left:50%; transform:translateX(-50%); display:flex; gap:10px; z-index:70; }
  .dot{ width:12px;height:12px;border-radius:50%; background:rgba(255,255,255,0.85); border:1px solid rgba(212,175,55,0.08); cursor:pointer; }
  .dot.active{ background:var(--gold); box-shadow:0 12px 30px rgba(212,175,55,0.14); transform:scale(1.3); }

  .spinner{ position:absolute; width:56px;height:56px;border-radius:50%; border:6px solid rgba(255,255,255,0.6); border-top-color:var(--gold); animation:spin 1s linear infinite; z-index:80; right:50%; transform:translateX(50%); top:48%; }
  @keyframes spin{ to{ transform:rotate(360deg) translateX(50%); } }

  .vslider{ height:calc(60vh); border-radius:12px; display:flex; align-items:center; justify-content:center; position:relative; overflow:hidden; padding:18px; background:linear-gradient(180deg,#fffdf6,#fff); }
  .vtrack{ display:flex; height:100%; transition:transform var(--trans); width:100%; align-items:center; }
  .vslide{ min-width:100%; display:flex; align-items:center; justify-content:center; flex-direction:column; gap:8px; padding:8px; box-sizing:border-box; }
  .vframe{ width:calc(100% - 120px); max-width:1020px; height:100%; border-radius:12px; overflow:hidden; background:#000; display:flex; align-items:center; justify-content:center; border:1px solid rgba(212,175,55,0.06); box-shadow:0 20px 60px rgba(20,18,16,0.1); }
  .vframe video{ width:100%; height:100%; object-fit:contain; background:#000; display:block; }

  .varrow{ position:absolute; top:50%; transform:translateY(-50%); width:64px;height:64px;border-radius:50%; display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#fff,#fff7e6); border:2px solid rgba(212,175,55,0.1); font-size:28px; cursor:pointer; z-index:60; box-shadow:0 12px 40px rgba(20,18,16,0.12); }
  .varrow.left{ left:34px } .varrow.right{ right:34px }

  footer{ text-align:center; margin-top:18px; color:var(--muted); font-size:13px }

  @media (max-width:900px){
    .slider{ height:calc(72vh); }
    .vslider{ height:calc(72vh); }
    .arrow.left{ left:14px } .arrow.right{ right:14px }
    .varrow.left{ left:14px } .varrow.right{ right:14px }
    .photo-frame{ width:calc(100% - 48px); height:calc(100% - 120px); }
    .vframe{ width:calc(100% - 48px); height:calc(100% - 120px); }
  }
  @media (max-width:480px){
    .slider{ height:calc(68vh); }
    .vslider{ height:calc(68vh); }
    .photo-frame{ width:calc(100% - 36px); height:calc(100% - 120px); }
    .vframe{ width:calc(100% - 36px); height:calc(100% - 120px); }
    .arrow{ width:56px;height:56px;font-size:28px }
    .varrow{ width:56px;height:56px;font-size:24px }
  }
</style>
</head>
<body>
  <button id="musicBtn" class="music-btn" aria-pressed="false" title="–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É">üéµ</button>

  <div class="page">
    <header>
      <svg class="orn" viewBox="0 0 480 80" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <defs><linearGradient id="g" x1="0" x2="1"><stop offset="0" stop-color="#f9eac3"/><stop offset="1" stop-color="#d4af37"/></linearGradient></defs>
        <path d="M6 40 C86 6, 146 6, 240 40 C334 74, 394 74, 474 40" stroke="url(#g)" stroke-width="3.6" fill="none" stroke-linecap="round"/>
      </svg>
      <h1>–°–≤–∞–¥—å–±–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏–∏ –∏ –†–æ–º–∞–Ω–∞</h1>
    </header>

    <main class="stage-wrap" role="main">
      <section class="stage" id="photoStage" aria-label="–§–æ—Ç–æ">
        <div class="content">
          <div class="top-controls" role="toolbar" aria-label="–ö–æ–Ω—Ç—Ä–æ–ª—ã">
            <button id="downloadBtn" class="control-sm" title="–°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–µ–µ —Ñ–æ—Ç–æ">–°–∫–∞—á–∞—Ç—å</button>
            <button id="fullBtn" class="control-sm" title="–ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω">–ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω</button>
            <button id="slideBtn" class="control-sm" title="–°–ª–∞–π–¥-—à–æ—É">–°–ª–∞–π–¥-—à–æ—É</button>
          </div>

          <div class="slider" id="slider" aria-live="polite">
            <div class="slides" id="slides" role="list"></div>
            <button class="arrow left" id="prevBtn" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ">‚Äπ</button>
            <button class="arrow right" id="nextBtn" aria-label="–°–ª–µ–¥—É—é—â–µ–µ">‚Ä∫</button>
            <div class="dots" id="dots" role="tablist" aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è"></div>
            <div class="spinner" id="photoSpinner" style="display:none" aria-hidden="true"></div>
          </div>
        </div>
      </section>

      <section class="stage" id="videoStage" aria-label="–í–∏–¥–µ–æ">
        <div class="content">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
            <div style="font-weight:800;color:#111">–í–∏–¥–µ–æ</div>
            <div style="font-size:13px;color:var(--muted)">–õ–∏—Å—Ç–∞–π—Ç–µ –≤–ª–µ–≤–æ/–≤–ø—Ä–∞–≤–æ</div>
          </div>

          <div class="vslider" id="vslider" aria-live="polite">
            <div class="vtrack" id="vtrack" role="list"></div>
            <button class="varrow left" id="vprev" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ –≤–∏–¥–µ–æ">‚Äπ</button>
            <button class="varrow right" id="vnext" aria-label="–°–ª–µ–¥—É—é—â–µ–µ –≤–∏–¥–µ–æ">‚Ä∫</button>
            <div class="spinner" id="videoSpinner" style="display:none" aria-hidden="true"></div>
          </div>
        </div>
      </section>
    </main>

    <footer>¬© 2025 ‚Äî –ê–Ω–∞—Å—Ç–∞—Å–∏—è –∏ –†–æ–º–∞–Ω</footer>
  </div>

  <audio id="bgAudio" loop preload="none"></audio>

<script>
// ========== –ú–ï–î–ò–ê-–°–°–´–õ–ö–ò ==========
const IMAGE_URLS = [
  "https://disk.yandex.ru/i/TRXEn7REa1C3WA",
  "https://disk.yandex.ru/i/ghGxUUWgdb0KBg",
  "https://disk.yandex.ru/i/WiisfoiE6SuIPA",
  "https://disk.yandex.ru/i/FqCtgOis_onhsQ",
  "https://disk.yandex.ru/i/V8bTrKI0chQGWA",

  // –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ —Å—Å—ã–ª–∫–∏
  "https://disk.yandex.ru/i/8UVcVayWNW4x1g",
  "https://disk.yandex.ru/i/vynW3QSn9mcCIw",
  "https://disk.yandex.ru/i/uUx4BpY0upJnbw",
  "https://disk.yandex.ru/i/FOftnRyaG0jtrA",
  "https://disk.yandex.ru/i/V8qocwaUI6Nw7g",
  "https://disk.yandex.ru/i/dT-dJ0WvA-RvjA",
  "https://disk.yandex.ru/i/PgDStDnAhTNz4w",
  "https://disk.yandex.ru/i/Lqzj5cGSZd_4kw",
  "https://disk.yandex.ru/i/6y8AQzdHKTIK9Q",
  "https://disk.yandex.ru/i/6pnbbPTHKLrfGw",
  "https://disk.yandex.ru/i/R7G_XOzYk6qJow",
  "https://disk.yandex.ru/i/C5Rr7OljIxvQzA",
  "https://disk.yandex.ru/i/2ojSo6n55ViIWA",
  "https://disk.yandex.ru/i/uxe-n2e9mpN6IA",
  "https://disk.yandex.ru/i/aczqsLqFoQlTZA",
  "https://disk.yandex.ru/i/fWaxeAQ9yR6HgQ",
  "https://disk.yandex.ru/i/z0kbHkLag_pw7A",
  "https://disk.yandex.ru/i/2_W1GAzgFpAsug",
  "https://disk.yandex.ru/i/IRH6-69sJp05NQ",
  "https://disk.yandex.ru/i/p71FrTBzk-s9aA",
  "https://disk.yandex.ru/i/p36QnMOwbix4qQ",
  "https://disk.yandex.ru/i/2kWqak1qEd7ltg",
  "https://disk.yandex.ru/i/-RM5abuz4rNMug",
  "https://disk.yandex.ru/i/HNWaSQR3SLOq5A",
  "https://disk.yandex.ru/i/IPM8-y6URmPN9Q",
  "https://disk.yandex.ru/i/dJErjX8LwP3zQg",
  "https://disk.yandex.ru/i/KtI43qiz5WQdjQ",
  "https://disk.yandex.ru/i/zv5yLi3_-OXQkQ",
  "https://disk.yandex.ru/i/ktuRsLuBz39Mmw",
  "https://disk.yandex.ru/i/r1k5u3qoZRG-Zw",
  "https://disk.yandex.ru/i/EHRCmRUSS_XQYQ",
  "https://disk.yandex.ru/i/d9GNT-KOUMwq2A",
  "https://disk.yandex.ru/i/Yd0Xfz0VfmAcfA",
  "https://disk.yandex.ru/i/fL_TP-_wYcm3DA",
  "https://disk.yandex.ru/i/YiIHVPK0Xkw0Rw",
  "https://disk.yandex.ru/i/XHEpzwcDkl35VQ",
  "https://disk.yandex.ru/i/J8Dcj5csZbZkEg",
  "https://disk.yandex.ru/i/tiUPgm-EnIcp1w",
  "https://disk.yandex.ru/i/41Xncv9lr1xjbA",
  "https://disk.yandex.ru/i/Ba0dRvw3Z8u6LA",
  "https://disk.yandex.ru/i/zkBxEZa7brzTzQ",
  "https://disk.yandex.ru/i/gPIYgJCtTcHv8Q",
  "https://disk.yandex.ru/i/miq7_qzWtuqJ0Q",
  "https://disk.yandex.ru/i/3MnnU-BZa9m4kA",
  "https://disk.yandex.ru/i/D85o9Vga6-euVQ",
  "https://disk.yandex.ru/i/zXvAcv2WJxb0YA",
  "https://disk.yandex.ru/i/jZn0JlTeQGqolQ",
  "https://disk.yandex.ru/i/hPTvAXhg9LpZ7Q",
  "https://disk.yandex.ru/i/nnM3XwF4pttEvg",
  "https://disk.yandex.ru/i/QO3lmWl07lL92Q",
  "https://disk.yandex.ru/i/IJ04WsgweB_j9w",
  "https://disk.yandex.ru/i/5StpvHq6u7u5_g",
  "https://disk.yandex.ru/i/woXslcRJosJWSA",
  "https://disk.yandex.ru/i/7uahwtiDbNjVig",
  "https://disk.yandex.ru/i/BvV7X2Ne-jotJw",
  "https://disk.yandex.ru/i/xfC3Qnrk6OudTw",
  "https://disk.yandex.ru/i/PBTcQFqhVPBzxg",
  "https://disk.yandex.ru/i/cd6yx26vxtaWbA",
  "https://disk.yandex.ru/i/OOJ7mKWS-iVVLQ",
  "https://disk.yandex.ru/i/nMlcFEB8GtgG6Q",
  "https://disk.yandex.ru/i/5rRqunRvWgT-kg",
  "https://disk.yandex.ru/i/00VYMPPrWvY_UA",
  "https://disk.yandex.ru/i/WjY-Ch0pEcwaFw",
  "https://disk.yandex.ru/i/jGVt1zkr7Udrng",
  "https://disk.yandex.ru/i/OK8zG8OPCHDgLw",
  "https://disk.yandex.ru/i/NLBQA40dinp1-A",
  "https://disk.yandex.ru/i/Rz-b2tymNX8ojg",
  "https://disk.yandex.ru/i/CBC7otKT9u-y1w",
  "https://disk.yandex.ru/i/azmOru08jkcrxQ",
  "https://disk.yandex.ru/i/ykgxadRg1mp7gQ",
  "https://disk.yandex.ru/i/k0LwZYA5HW-3uQ",
  "https://disk.yandex.ru/i/0WUG_qgE69rd0g",
  "https://disk.yandex.ru/i/-5yJIt9C4JSSXQ",
  "https://disk.yandex.ru/i/xyUgohmomrwMsA",
  "https://disk.yandex.ru/i/fCxKDwQBBDKg8w",
  "https://disk.yandex.ru/i/_eWhS03yXitozA",
  "https://disk.yandex.ru/i/ParkfgyiarIDRw",
  "https://disk.yandex.ru/i/1AeReD6PttI5MQ",
  "https://disk.yandex.ru/i/985IDrunchAUOw",
  "https://disk.yandex.ru/i/8OLufuCOi8_S2Q",
  "https://disk.yandex.ru/i/4WhgVIyKxmZnYA",
  "https://disk.yandex.ru/i/grLAYwemj-fprA",
  "https://disk.yandex.ru/i/utLfbkZ3pn301A",
  "https://disk.yandex.ru/i/JabrSJ0OQl96nA",
  "https://disk.yandex.ru/i/7qvoPDcwvnV6FA",
  "https://disk.yandex.ru/i/6EgZRZ-1kMondQ",
  "https://disk.yandex.ru/i/j3voDGF3d_rPUQ",
  "https://disk.yandex.ru/i/yGsS9PcDAOcSIg",
  "https://disk.yandex.ru/i/ZICCD3Hge_9CQQ",
  "https://disk.yandex.ru/i/Y4LGqkyq-oe4-w",
  "https://disk.yandex.ru/i/3KhxbcVpNJEGQA",
  "https://disk.yandex.ru/i/-FnUyeb0Vc7xAQ",
  "https://disk.yandex.ru/i/7xbVX9aogU7kjw",
  "https://disk.yandex.ru/i/lFj4TNmqrb4ayQ",
  "https://disk.yandex.ru/i/odu1eQXRZTwAiQ",
  "https://disk.yandex.ru/i/S8Lc_IQ_fL_P6Q",
  "https://disk.yandex.ru/i/dJnF7Vk5HxZDLw",
  "https://disk.yandex.ru/i/pWeqDTx27DkZ4Q",
  "https://disk.yandex.ru/i/vfD7GKh4MpfC2A",
  "https://disk.yandex.ru/i/8b1ezDCtbBT5Nw",
  "https://disk.yandex.ru/i/OOqz_JsByLk5Yw",
  "https://disk.yandex.ru/i/if4Evt849GcI6Q",
  "https://disk.yandex.ru/i/0HuokNkkPQgWOw",
  "https://disk.yandex.ru/i/LgJ5Vm5sufCwqA",
  "https://disk.yandex.ru/i/yL7SN5E8mbOxlg",
  "https://disk.yandex.ru/i/VYwxkNzlt1HXYQ",
  "https://disk.yandex.ru/i/6CjP8cyAQZnucg",
  "https://disk.yandex.ru/i/UU-Vt3hRCbq--w",
  "https://disk.yandex.ru/i/sYza-Cfx4Ipffg",
  "https://disk.yandex.ru/i/DVgp38RO66d4vw",
  "https://disk.yandex.ru/i/4KlpKv8R3UUO5A",
  "https://disk.yandex.ru/i/JDtgFpww4cxU9g",
  "https://disk.yandex.ru/i/boAk6nAAqW1JTA",
  "https://disk.yandex.ru/i/tQJsEXJnIETHDw",
  "https://disk.yandex.ru/i/4JVCa1V31KeyOg",
  "https://disk.yandex.ru/i/I_djgvDAVwR6HQ",
  "https://disk.yandex.ru/i/GYXiHDBRB-VNEQ",
  "https://disk.yandex.ru/i/B08QjByQPNtj5A",
  "https://disk.yandex.ru/i/hQB_6C7R5-6whg",
  "https://disk.yandex.ru/i/7TnjNUyZ5mVwCQ",
  "https://disk.yandex.ru/i/VK7MEB9i5_ipVQ",
  "https://disk.yandex.ru/i/Bf_kB9Mb69Kd8A",
  "https://disk.yandex.ru/i/BnaSVz84KdXgyw",
  "https://disk.yandex.ru/i/phcyW5_aU9VT0Q",
  "https://disk.yandex.ru/i/TXfMCLi-Ycallw"
];

const VIDEO_URLS = [
  "https://disk.yandex.ru/i/aVIzdxyn1sFOMQ",
  "https://disk.yandex.ru/i/Z5-NQ3nAHVmHMA"
];

const MUSIC_PUBLIC = "https://disk.yandex.ru/d/C35zD0rWMPDJmQ";

// ========== –§–û–¢–û –°–õ–ê–ô–î–ï–† ==========
const slidesEl = document.getElementById('slides');
const dotsEl = document.getElementById('dots');
const photoSpinner = document.getElementById('photoSpinner');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const fullBtn = document.getElementById('fullBtn');
const slideBtn = document.getElementById('slideBtn');
const downloadBtn = document.getElementById('downloadBtn');

let photoState = { 
  index: 0, 
  items: [], 
  autoplay: false, 
  timer: null,
  isMobile: /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)
};

function buildPhotos() {
  photoSpinner.style.display = 'block';
  
  for (let i = 0; i < IMAGE_URLS.length; i++) {
    const slide = document.createElement('div');
    slide.className = 'slide';
    
    const frame = document.createElement('div');
    frame.className = 'photo-frame';
    
    const localSpin = document.createElement('div');
    localSpin.className = 'spinner';
    frame.appendChild(localSpin);

    const img = document.createElement('img');
    img.alt = `–§–æ—Ç–æ ${i + 1}`;
    img.loading = 'lazy';
    
    img.src = IMAGE_URLS[i];
    
    img.onload = () => {
      localSpin.style.display = 'none';
    };
    
    img.onerror = () => {
      localSpin.style.display = 'none';
      console.warn(`Failed to load image ${i}`);
    };

    frame.appendChild(img);
    slide.appendChild(frame);
    slidesEl.appendChild(slide);

    const dot = document.createElement('button');
    dot.className = 'dot';
    dot.dataset.index = i;
    dot.setAttribute('aria-label', `–ö —Ñ–æ—Ç–æ ${i + 1}`);
    dot.addEventListener('click', () => gotoPhoto(i));
    dotsEl.appendChild(dot);

    photoState.items.push({ slide, frame, img, originalUrl: IMAGE_URLS[i] });
  }
  
  photoSpinner.style.display = 'none';
  updatePhoto();
  
  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
  slidesEl.addEventListener('click', (e) => {
    if (e.target.closest('.photo-frame')) openFullscreen();
  });
  
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowRight') nextPhoto();
    if (e.key === 'ArrowLeft') prevPhoto();
    if (e.key === 'Escape') exitFullscreenIfNeeded();
  });
  
  setupSwipeSlides();
}

function updatePhoto() {
  slidesEl.style.transform = `translateX(-${photoState.index * 100}%)`;
  photoState.items.forEach((it, i) => it.slide.classList.toggle('active', i === photoState.index));
  [...dotsEl.children].forEach((d, i) => d.classList.toggle('active', i === photoState.index));
}

function nextPhoto() {
  photoState.index = (photoState.index + 1) % photoState.items.length;
  updatePhoto();
}

function prevPhoto() {
  photoState.index = (photoState.index - 1 + photoState.items.length) % photoState.items.length;
  updatePhoto();
}

function gotoPhoto(i) {
  photoState.index = i;
  updatePhoto();
}

prevBtn.addEventListener('click', prevPhoto);
nextBtn.addEventListener('click', nextPhoto);

// –°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–µ–µ —Ñ–æ—Ç–æ
downloadBtn.addEventListener('click', () => {
  const currentIndex = photoState.index;
  const originalUrl = photoState.items[currentIndex].originalUrl;
  
  // –û—Ç–∫—Ä—ã–≤–∞–µ–º –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ - —ç—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
  window.open(originalUrl, '_blank');
});

// –°–ª–∞–π–¥-—à–æ—É
slideBtn.addEventListener('click', () => {
  photoState.autoplay = !photoState.autoplay;
  slideBtn.textContent = photoState.autoplay ? '–°—Ç–æ–ø' : '–°–ª–∞–π–¥-—à–æ—É';
  if (photoState.autoplay) {
    photoState.timer = setInterval(nextPhoto, 4500);
  } else {
    clearInterval(photoState.timer);
    photoState.timer = null;
  }
});

// –°–≤–∞–π–ø—ã
function setupSwipeSlides() {
  let sx = 0;
  slidesEl.addEventListener('touchstart', e => {
    sx = e.touches[0].clientX;
  }, { passive: true });
  
  slidesEl.addEventListener('touchend', e => {
    const ex = e.changedTouches[0].clientX;
    const dx = ex - sx;
    if (dx > 60) prevPhoto();
    else if (dx < -60) nextPhoto();
  }, { passive: true });
}

// –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
const photoStage = document.getElementById('photoStage');
async function openFullscreen() {
  try {
    if (photoStage.requestFullscreen) {
      await photoStage.requestFullscreen();
    } else if (photoStage.webkitRequestFullscreen) {
      await photoStage.webkitRequestFullscreen();
    } else if (photoStage.mozRequestFullScreen) {
      await photoStage.mozRequestFullScreen();
    } else if (photoStage.msRequestFullscreen) {
      await photoStage.msRequestFullscreen();
    }
  } catch(e) {
    console.warn('Fullscreen failed', e);
  }
}

fullBtn.addEventListener('click', openFullscreen);

function exitFullscreenIfNeeded() {
  if (document.fullscreenElement || document.webkitFullscreenElement || 
      document.mozFullScreenElement || document.msFullscreenElement) {
    if (document.exitFullscreen) {
      document.exitFullscreen();
    } else if (document.webkitExitFullscreen) {
      document.webkitExitFullscreen();
    } else if (document.mozCancelFullScreen) {
      document.mozCancelFullScreen();
    } else if (document.msExitFullscreen) {
      document.msExitFullscreen();
    }
  }
}

// ========== –í–ò–î–ï–û –°–õ–ê–ô–î–ï–† ==========
const vtrack = document.getElementById('vtrack');
const vprev = document.getElementById('vprev');
const vnext = document.getElementById('vnext');
const videoSpinner = document.getElementById('videoSpinner');
let videoState = { index: 0, items: [] };

function buildVideos() {
  videoSpinner.style.display = 'block';
  
  for (let i = 0; i < VIDEO_URLS.length; i++) {
    const vslide = document.createElement('div');
    vslide.className = 'vslide';
    
    const vframe = document.createElement('div');
    vframe.className = 'vframe';
    
    const video = document.createElement('video');
    video.controls = true;
    video.preload = 'metadata';
    video.playsInline = true;
    video.setAttribute('webkit-playsinline', 'true');
    
    const source = document.createElement('source');
    source.src = VIDEO_URLS[i];
    source.type = 'video/mp4';
    video.appendChild(source);
    
    vframe.appendChild(video);
    vslide.appendChild(vframe);
    vtrack.appendChild(vslide);
    videoState.items.push({ vslide, video });
    
    video.addEventListener('play', onVideoPlay);
    video.addEventListener('pause', onVideoPause);
    video.addEventListener('ended', onVideoPause);
  }
  
  videoSpinner.style.display = 'none';
  updateVideo();
  setupSwipeVideos();
}

function updateVideo() {
  vtrack.style.transform = `translateX(-${videoState.index * 100}%)`;
}

function nextVideo() {
  if (videoState.items[videoState.index] && videoState.items[videoState.index].video) {
    videoState.items[videoState.index].video.pause();
  }
  
  videoState.index = (videoState.index + 1) % videoState.items.length;
  updateVideo();
}

function prevVideo() {
  if (videoState.items[videoState.index] && videoState.items[videoState.index].video) {
    videoState.items[videoState.index].video.pause();
  }
  
  videoState.index = (videoState.index - 1 + videoState.items.length) % videoState.items.length;
  updateVideo();
}

vprev.addEventListener('click', prevVideo);
vnext.addEventListener('click', nextVideo);

function setupSwipeVideos() {
  let sx = 0;
  vtrack.addEventListener('touchstart', e => {
    sx = e.touches[0].clientX;
  }, { passive: true });
  
  vtrack.addEventListener('touchend', e => {
    const ex = e.changedTouches[0].clientX;
    const dx = ex - sx;
    if (dx > 60) prevVideo();
    else if (dx < -60) nextVideo();
  }, { passive: true });
}

// ========== –ú–£–ó–´–ö–ê ==========
const musicBtn = document.getElementById('musicBtn');
const bgAudio = document.getElementById('bgAudio');
let musicPlaying = false;
let musicWasPlayingBeforeVideo = false;

musicBtn.addEventListener('click', () => {
  if (!bgAudio.src) {
    bgAudio.src = MUSIC_PUBLIC;
  }
  
  if (!musicPlaying) {
    try {
      bgAudio.play();
      musicPlaying = true;
      musicBtn.classList.add('play');
      musicBtn.setAttribute('aria-pressed', 'true');
    } catch(err) {
      console.warn('Playback failed', err);
      alert('–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –±—Ä–∞—É–∑–µ—Ä–æ–º ‚Äî –Ω–∞–∂–º–∏—Ç–µ –µ—â—ë —Ä–∞–∑.');
    }
  } else {
    bgAudio.pause();
    musicPlaying = false;
    musicBtn.classList.remove('play');
    musicBtn.setAttribute('aria-pressed', 'false');
  }
});

function onVideoPlay() {
  if (bgAudio.src && !bgAudio.paused) {
    musicWasPlayingBeforeVideo = true;
    bgAudio.pause();
    musicPlaying = false;
    musicBtn.classList.remove('play');
  } else {
    musicWasPlayingBeforeVideo = false;
  }
}

function onVideoPause() {
  const anyPlaying = videoState.items.some(it => it.video && !it.video.paused && !it.video.ended);
  if (!anyPlaying && musicWasPlayingBeforeVideo) {
    bgAudio.play().then(() => {
      musicPlaying = true;
      musicBtn.classList.add('play');
    }).catch(() => {});
    musicWasPlayingBeforeVideo = false;
  }
}

// ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
function init() {
  buildPhotos();
  buildVideos();
  updatePhoto();
  updateVideo();
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–≥–¥–∞ DOM –≥–æ—Ç–æ–≤
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', init);
} else {
  init();
}
</script>
</body>
</html>
